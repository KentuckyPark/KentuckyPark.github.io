# ICARUS: Attacking low Earth orbit satellite networks Paper Review



# Abstract

저궤도 위성에 기반한 인터넷 서비스의 규모는 커지지만 지금까지 운영의 보안이 소홀이 다루어져 왔다.

이러한 맥락에서 저자는 새로운 종류의 DoS 공격인 ICARUS를 소개한다. ICARUS는 이러한 LEO 네트워크의 주요 장점을 취약점으로 바꾸어 공격자가 직접 글로벌 접근성을 활용하여 수많은 위치에서 공격을 시작할 수 있으며 낮은 지연 시간을 추구하기 때문에 라우팅이 제한되고 공격자에게 예측 가능성을 제공한다.

공격자가 이러한 네트워크의 경로 구조, 위성 라우터의 위치 및 연결성에 대한 대중의 지식 등 다른 고유한 특징을 어떻게 악용할 수 있는지 살펴본다. 또한, 소량의 공격 대역폭으로도 대규모 지상 지역 간의 통신을 방해할 수 있다는 사실을 발견 했다.

마지막으로 이러한 방향으로 미해결 문제를 제시하고 공격과 방어에 대한 추가 연구를 가능하게 하는 프레임워크를 제공한다.



# Introduction

SpaceX Starlink, Amazon Kuiper 등은 각각 고용량 네트워킹 장비를 탑재한 수백에서 수천 개의 위성을 배치하고 있다.

이러한 저궤도 위성 네트워크(LSN, Low earth orbit Satellite Networks)는 글로벌 광대역 인터넷 서비스를 제공하는 것을 목표로 한다. 글로벌 액세스는 그 자체로 연결성의 비약적인 발전이지만, 이러한 네트워크는 서로 잘 연결되어 있지 않은 지역간의 저지연 통신도 보장한다.

최근 연구에 따르면 수천 킬로미터를 넘어서는 장거리 통신의 경우 이러한 네트워크가 오늘날의 광섬유 인터넷 뿐만 아니라 특수 자유 공간 무선 네트워크(specialized free-space radio networking)보다 더 짧은 지연 시간을 제공할 수 있다고 한다. 글로벌 저지연 네트워크의 흥미로운 잠재력에 힘입어 연구자들은 지연 시간 개선 추정, 네트워크 토폴로지 설계, 새로운 라우팅 전략 등 LSN과 관련된 많은 흥미로운 문제를 탐구하고 있다.

그러나 지금까지의 연구들은 이러한 네트워크의 안전한 운영이라는 측면은 거의 무시하였다.

따라서 이 논문에서는 손상된 위성 지원 호스트(compromised satellite-enabled hosts)로 구성된 봇넷에 의해 수행되는 대규모 볼륨 분산 서비스 거부(DDoS)공격에 대한 LSN의 복원력을 살펴본다. 이 위협은 지상 네트워크에서 광범위하게 연구되어 왔지만, ==공격자는 Global footprint를 활용하여 네트워크 트래픽을 유연하게 주입(inject)할 수 있고 노드 위치 및 네트워크 구조에 대한 지식은 폐쇄적이지 않다(far from being closely guarded) 이는 공개 정보를 쉽게 이용할 수 있으며, 지연 시간이 짧아 경로 다양성을 제한하고 공격 경로에 대한 불확실성을 줄인다.==

공격자에게 도전적인 측면도 존재한다. ==지상 전송 네트워크와 달리 LSN은 트래픽을 주입하는 클라이언트에 직접 연결되므로 악의적인 행위를 더 쉽게 탐지하고 차단할 수 있으며, 적어도 초기에는 클라이언트 수가 인터넷보다 훨씬 적어 공격자의 리소스가 제한되고, 위성 간 네트워크의 희박한 구조로 인해 트래픽 공격이 목표가 아닌 다른 부분을 혼잡하게 만들수도 있다.==

이러한 특별한 상황을 활용하고 새로운 도전과제를 해결하기 위해 저자는 LSN에 대한 DDoS공격인 ICARUS를 소개한다. ICARUS는 Coremelt, Crossfire 및 기타 DDoS 기법을 활용하지만, 공격자는 공격 대상 링크 또는 대상 링크 집합을 혼잡하게 할 목적으로 LSN의 구조를 사용하여 공격 트래픽을 신중하게 계획한다. ==공격자는 공격 트래픽 양 측면에서 낮은 비용으로, 개별 위성 수신 대역폭 변화 측면에서 낮은 탐지 가능성으로 공격을 수행하고자 한다.==

새로운 환경에 대한 직관력을 키우기 위해 먼저 LSN이 단일 최단 경로 라우팅을 사용하는 시나리오에서 ICARUS를 분석함. 현재까지 가장 많이 이용되는 Starlink를 통해 LSN에 대한 공격을 시뮬레이션한 결과 공격자가 대부분의링크를 성공적으로 표적으로 삼아 지상-위성 간 링크와 위성 간 링크(ISL)을 모두 혼잡하게 만들 수 있다는 사실을 발견함. 대규모 지역간의 연결을 방해하는 다중 표적 공격도 단일 표적 공격에 비해 탐지 가능성이 높지 않으면서도 다소 높은 비용으로 가능함.

실제로 LSN은 무작위 로드 밸런싱을 통해 잠재적으로 다중 경로 라우팅을 활용할 수 있음. 따라서 라우팅의 불확실성에도 불구하고 높은 확률로 타겟을 혼잡하게 만들 수 있는 확률적 버전의 ICARUS도 소개됨. 본문에서는 이 공격을 네 가지 직관적인 라우팅 체계에 대해 분석함. 실험 결과  ICARUS는 단일 최단 경로 시나리오에 비해 약간의 추가 비용으로도 표적을 공격할 수 있는 것으로 나타남. 공격자가 탐지 위험을 최소화하고자 하는 경우 공격 비용을 가장 효과적으로 증가시키는 라우팅 체계는 중앙값 표적의 경우 385% 까지 공격 경로에 대한 지연 시간이 크게 증가하는데, 중앙 값의 경우 1.32배, 더 극단적인 경우 최대 2.04배 까지 지연 시간이 발생함. 이러한 지연 시간 증가에도 불구하고 절대적인 공격 비용 증가는 여전히 공격 트래픽의 80Gbps 미만에 불과하며, LSN이 약속한 봇당 수십 Mbps의 대역폭을 고려하면 수천 개의 봇을 공격할 수 있는 수준, 이는 공격자에게는 가장 비관적인 시나리오라고 볼 수 있음. 혼잡한 표적에 대한 기준을 낮출 수 있는 양호한 네트워크 트래픽이 없기 때문. ==LSN은 큰 지연 시간 저하를 기꺼히 감수함. 공격자는 비용보다는 탐지 가능성을 최소화하려고 함. 많은 환경에서는 수백 개의 봇으로도 충분함==

마지막으로 위성이 이동하고 경로가 변경됨에 따라 종단 간 경로의 지연 시간과 각 ISL이 전송하는 트래픽에 자연스러운 흐름(flux)이 발생하기 때문에 LSN의 동적 특성으로 인해 발생할 수 있는 추가 공격 기회를 간략하게 분석함. 공격자는 잠재적으로 지연 시간 변화를 활용하여 temporal lensing과 유사한 방법으로 단기간 동안 공격 흐름의 대역폭을 두 배로 늘릴 수 있다. 그러나 초기 연구 결과에 따르면 이 방법의 추가적인 효용성은 거의 없는 것으로 나타남. ==또한 공격자는 경로 변경으로 인한 링크 사용률의 자연스러운 급증과 일치하도록 공격 흐름의 시간을 조정할 수도 있음. 저자의 분석 결과 후자의 전력이 유망한 것으로 나타났지만 그 영향을 확인하려면 패킷 수준 분석이 필요함.==

해당 논문의 주요 Contribution

* DDoS에 취약점을 유발하는 LSN의 고유한 특징을 도출하여 지상 네트워크에서 잘 연구된 문제에 대한 새로운 분석에 동기를 부여함
* 이러한 고유한 기능을 악용하여 LSN의 표적 링크를 성공적으로 혼잡하게 만드는 ICARUS 공격에 대해서 소개함. ICARUS는 비용과 탐지 가능성 측면에서 LSN 설정이 공격자에게 제기하는 새로운 문제를 해결함. 
* 간단한 단일 최단 경로 라우팅 설정을 사용하여 직관력을 키우고, 대규모 지역 간의 연결이 ICARUS로 인해 어떻게 방배 받을 수 있는지 보여줌.
* ICARUS를 무작위 다중 경로 라우팅 시나리오로 확장하고 네 가지 직관적인 라우팅 체계와 비교하여 평가한 결과, 공격이 여전히 높은 확률로 성공한다는 것을 확인함.

저자는 ICARUS가 LSN을 대상으로 한 최초의 대규모 DDoS 공격이라고 주장

*__Temporal lensing__: 시간적으로 짧은 기간 동안 공격 흐름의 대역폭을 두 배로 증가시킬 수 있는 기술. 이는 LSN의 동적 특성, 즉 위성이 움직이고 경로가 변경됨에 따라 발생하는 종단 간 경로의 지연 시간과 각 ISL이 처리하는 트래픽의 변화를 활용함*

*__Global footprint__: 네트워크가 전 세계적으로 서비스를 제공할 수 있는 범위를 의미함 LSN의 경우 위성 네트워크는 전 지구적인 커버리지를 가지므로 어디에서나 데이터를 전송하고 수신할 수 있는 능력을 가짐*

*__Inject Traffic__: 네트워크에 데이터나 신호를 보내는 것을 의미*

*__Coremelt__: DDoS 공격의 일종으로 네트워크의 핵심 부분, 즉 코어 네트워크를 목표로 함. 이 공격은 네트워크의 중요한 노드들 사이에서 대량의 가짜 트래픽을 생성하여 코어 네트워크를 포화시키는 방식으로 작동함. 이런 방식은 네트워크의 핵심 구성 요소를 마비시켜 전체 네트워크의 성능을 저하시킬 수 있음. Coremelt 공격은 특히 네트워크 내부에서 발생하며, 외부 트래픽을 필터링하는 기존의 DDoS 방어 매커니즘을 우회할 수 있음*

*__Crossfire__: 고도로 분산된 DDoS 공격 유형으로, 특정한 네트워크 경로나 지역을 목표로 함. 이 공격은 공격자가 제어하는 대규모의 봇넷을 사용하여 특정 지역의 ISP나 중요한 네트워크 링크를 공격함. Crossfire 공격은 정상적인 트래픽과 유사한 가짜 트래픽을 생성하여 탐지를 어렵게 만듬. 공격은 대상 지역의 네트워크 자원을 고갈시키고, 서비스 중단을 일으키며, 특정 지역의 인터넷 접근을 차단할 수 있음*



# 2. Background & related work

저자의 기여는 곧 출시될 대규모 LSN에 대한 초기 연구와 잘 연구된 DoS 공격이 교차하는 지점에 놓여있어 이 두가지의 관련 배경을 소개함

## 2.1. LEO satellite networks

현재 제안되었거나 배치 중인 LSN에서는 수백에서 수천 개의 위성이 동일한 간격의 궤도면에 배치되며, 각 궤도면에는 동일한 수의 위성이 배치됨. ==위성은 무선 링크를 통해 지상의 터미널 유닛(TU)에 연결됨. 동시에 위성은 레이저 ISL을 통해 서로 연결될 수 있음. 각 궤도는 해발 고도가 고정되어 있으며 2000km 미만은 LEO로 간주됨. 지상과의 상대적 근접성은 신호가 훨씬 더 먼 거리를 이동해야 하기 때문에 통신 지연 시간 측면에서 큰 이점을 제공함.==

<img src="assets/image-20240128004006759.png" alt="image-20240128004006759" style="zoom:150%;" />'

**그림 1: 위성 포워딩.** 위성 지원(Satellite-enabled) 호스트는 무선 업링크 및 다운링크를 사용하여 오버헤드 위성과 통신함. 트래픽은 ISL을 통해 위성에서 위성으로 라우팅됨

예를 들어 35,786km의 정지궤도 위성에 도달하는 것보다 더 짧은 거리에서 위성에 도달할 수 있음

대부분의 제안된 별자리(Constellation)에서 궤도면은 적도면과 90도 각도로 교차하지 않으므로 지구의 극지방을 통과하지 않음. 대신 경사각이 낮을수록 위성이 저위도에서 더 많은 시간을 보낼 수 있으므로 극지방을 피하면서 인구가 많은 지역의 커버리지를 개선할 수 있음

분석 전반에 걸쳐 위의 매개변수가 있는 SpaceX Starlink Constellation의 첫 번째 첫번째 shell을 사용함:*72개의 궤도면, 각각 22개의 위성, 높이 550km, 궤도 경사 53도*

### Satellite-ground connectivity

그림 1은 일반적인 LSN 통신 시나리오를 보여줌 TU은 지상의 클라이언트에 설치되어 있음. 각 위성은 다중 빔 안테나 덕분에 여러 TU와 동시에 연결할 수 있음. ==저자는 위성과 주고받는 총 용량을 uplink와 downlink라 부름. 최근 FCC 제출 자료에 근거하여 업링크 및 다운링크 용량을 모두 4Gbps로 가정하여 분석함.==

TU는 수평성 상에서 최소 고도 각도(minimum elevation angle) 이상에 있는 오버헤드 위성과 통신할 수 있음. 이 각도는 별자리마다 다르며, 커버리지 영역 또는 지상 수신 범위와 달성 가능한 통신 속도 사이의 절충점을 나타냄. 고도각이 클수록 지상 수신 범위(footprint)는 작아지지만 대기권 내 경로가 짧아지고 주파수 재사용이 용이해져 용량이 증가함. 스타링크 shell 1의 경우 최소 고도각은 40도로 계획되어 있음

### Inter-satellite connectivity

==제안된 위성군의 주요 특징은 각 위성에서 레이저 위성 간 링크(ISL)를 사용한다는 것임. 일반적인 접근 방식은 위성당 4개의 ISL을 사용하는 것으로 2개는 동일한 궤도면에 있는 전방 및 후방 위성에 연결하고 2개는 인접 궤도면에 있는 위성에 연결하는 것임. 그 결과 생성된 ISL 토폴로지는 TU 간 트래픽을 전송하는 데 사용됨. 그림 1에서 볼 수 있듯이 트래픽은 업링크를 통해 TU에서 가시권 내 위성으로 전달된 다음 여러 ISL을 거쳐 다운링크를 통해 최종 목적지로 전달될 수 있음. 특히 구축 초기 단계에 있는 일부 별자리는 ISL을 포기하는 대신 지상국 간 일련의 상/하향 전송을 통해 데이터를 전송할 수 있음.==

예를 들어 Starlink의 경우 배포 초기 단계에 있음. ==그러나 ISL은 스타링크보다 성숙한 배포를 포함하여 향후 LSN의 핵심 구성 요소가 될 것으로 에상되며, 많은 이점을 달성하는 데 매우 중요함. 따라서 저자는 ISL이 있는 환경에 대한 분석에 초점을 맞춤. ISL이 없는 LSN은 엄밀히 말해 공격 대상이 더 쉬움.== 지상-위성 링크는 각 위성이 최대 몇 Gbps의 업링크를 지원하는 등 ISL 보다 훨씬 낮은 용량을 가지므로 혼잡을 일으키려는 공격자의 목표를 단순화할 수 있기 때문. 반면 이전 연구와 레이저 장비 공급업체의 제품에 따르면 ISL은 최대 20Gbps의 Full-duplex 전송이 가능할 것이라고 하며 이는 네트워크 용량을 크게 늘릴 수 있을 것이라고 함.

### Benefits: global low-latency broadband

수천 개의 위성에 연결하여 각각 멀티 기가비트 연결을 제공하는 LSN은 전 세계를 광대역 인터넷으로 덮을 수 있음 인터넷 서비스가 제공되지 않는 지역으로 인터넷 커버리지를 확장할 수 있는 잠재력 외에도, 이미 인터넷이 잘 연결된 지역에서도 지연 시간이 짧은 연결을 제공할 수 있는 잠재력 때문에 LSN에 대한 기대가 높아지고 있음. 이전 연구에 따르면 LSN은 오늘날의 인터넷에 비해 장거리 경로의 지연 시간을 2배 이상 줄일 수 있을 것으로 예상됨. 지연 시간 단축에는 두 가지 요인이 있음. 1. 진공 상태에서의 빛의 속도는 광섬유라는 유리 매질에서의 빛의 속도보다 약 50%더 빠름. 2. 일련의 ISL은 종종 광섬유가 지상에서 달성할 수 있는 것보다 더 직접적인 TU 간 경로를 제공할 수 있음



## 2.2 Denial of service

서비스 거부라는 용어는 다양한 종류의 공격을 포괄함. DoS 공격은 네트워크의 여러 계층에 있는 다양한 리소스를 표적으로 삼을 수 있음. 우리는 이전 섹션에서 미리 설명한 특성에서 비롯된 LSN에 특유한 통신 위협을 발견하고 분석하는 데 관심이 있음. 봇 마스터는 볼륨 DDoS 공격 중에 수천에서 수백만 개의 봇, 즉 손상된 호스트의 트래픽을 네트워크의 표적 요소로 유도하여 압도함. 봇넷은 일반적으로 전 세계에 분산된 봇으로 구성되며 서버, 엔드호스트, 라우터 등이 공격 대상이 될 수 있음. 전통적인 DDoS 공격은 트래픽을 표적 엔드포인트로 전송함. Coremelt나 Crossfire와 같은 최신 공격은 네트워크 내 요소를 혼잡하게 하도록 설계되어 봇 간에 트래픽을 전송하거나 다양한 퍼블릭 서버에 대한 연결을 초기화하는 방식으로 트래픽을 합법적인 트래픽과 원치 않는 트래픽으로 분류하는 기존 방식을 무시

### Coremelt & Crossfire

코어멜트에서 공격자는 N개의 봇 사이에서 생성된 합법적으로 보이는 플로우를 사용하여 표적 도메인 간 링크를 혼잡하고 만들려고 시도함. 봇을 통해 공격자는 타깃을 통과하는 흐름을 시작할 수 있음. 링크와 리소스가 충분하면 공격자는 네트워크의 모든 링크를 성공적으로 혼잡시킬 수 있다. 

크로스파이어는 이 아이디어를 확장한 것, 크로스파이어를 사용하면 공격자는 전체 네트워크 간의 통신을 방해할 수 있다. 봇이 전략적으로 선택된 서버에 동시에 연결하여 공격 대상 지역으로 연결되는 링크에 과부하가 발생하기 때문. 두 공격 모두 공격자가 구별할 수 없는 합법적인 트래픽을 사용하기 때문에 방어하기 어려운 것으로 악명이 높음. 섹션7에서는 Coremelt와 Corssfire에 사용할 수 있는 몇 가지 완화 방법을 직접 사용할 수 없기 때문에 ICARUS가 더 큰 위협이 될 수 있다고 주장



# 3. ICARUS adversary Model

ICARUS 공격자는 LSN에 연결되는 TU가 장착된 손상된 호스트의 봇넷을 제어함. 공격자는 이러한 봇을 악용하여 LSN을 통해 트래픽을 전송하여 링크를 혼잡하게 하고 정상 사용자가 제어하는 다른 TU 간의 통신을 방해함

## 3.1. The adversary's objective

공격자는 소스 봇과 대상 봇을 신중하게 선택하여 정상적으로 보이는 트래픽을 생성하고 특정 LSN 링크의 용량을 소진하여 표적 통신을 방해하려고 함. 구체적인 대상은 다음과 같음

* 위성 업링크 또는 다운링크. LSN에서 가장 낮은 대역폭의 링크이기 때문에 가장 쉬운 공격
* ISL. 혼잡한 ISL은 더 많은 소스-목적지 쌍에 대한 트래픽을 전달하기 때문에 잠재적으로 더 파괴적인 공격이 될 수 있음. 그러나 용량이 더 크기 때문에 업링크 및 다운링크보다 공격하기가 더 어려움
* 다중 링크. 저자는 공격자가 더 광범위한 공격 효과를 얻기 위해 표적 ISL and/or , up/downlink 의 조합을 선택하는 다중 링크 공격도 고려함. 예를 들어 공격자는 대상 소스-목적지 통신을 위해 로드 밸런싱 세트의 모든 링크를 제어하거나 두 개의 넓은 지상 지역을 연결하는 모든 링크를 표적으로 삼을 수 있음. 

해당 시뮬레이션에서는 링크 전체의 총 트래픽 수요가 용량을 초과하면 링크가 혼잡한 것으로 표시함. 실제로 통신 성능 저하는 이 임계값 이전부터 시작됨

## 3.2. Metrics of attack success

모든 표적에 대해 공격자는 낮은 비용으로 탐지를 피하면서 혼란을 야기하는데 관심이 있음. 

**Cost**. 공격 비용은 공격자가 공격 목표를 성공적으로 달성하기 위해 배포해야 하는 리소스를 측정함 공격 비용은 공격자가 공격에 성공하기 위해 생성해야 하는 트래픽 양(Gbps)로 표현함. Starlink의 초기 측정에서 볼 수 있듯이, 각 봇이 수십 Mbps의 공격 트래픽을 생성할 때 ISL의 20Gbps의 용량은 예를 들면 500개의 봇이 각각 40Mbps를 보내는 것과 같음

**탐지 가능성 및 maxUp**. LSN 운영자가 특정 위성이 업링크에서 받는 트래픽의 큰 변화를 보게 되면 운영자는 손상된 봇을 지역화하고 식별할 수 있음. ==따라서 탐지 가능성을 줄이기 위해 공격자는 공격 트래픽을 다수의 업링크에 걸쳐 분산시킬 것임. 탐지 가능성을 특성화하기 위해 저자는 LSN의 업링크에서 공격 트래픽에 의해 야기된 최대 절대 대역폭 증가(maxUp)을 사용함==. 저자는 상대적 증가가 아닌 절대 증가를 사용하여 다른 기준 트래픽 모델에서 시뮬레이션으로 얻는 비교 가능한 결과를 얻음

## 3.3. The adversary's capabilities & constraints

육상 네트워크와 달리 LSN의 많은 운영 측면은 공개적으로 알려져 있거나 추론될 수 있음

**LSN Topology.** 위성 궤도는 NORAD에 의해 지속적으로 업데이트되고 공개되는 공개 영역 정보임. 이러한 정보로부터 공격자는 선택된 공격 시간에 대한 위성의 정확한 위치를 계산할 수 있으며, 이러한 계산의 오류는 하루에 몇 킬로미터에 불과함. ISL 연결에 기대되는 전형적인 십자형 패턴을 사용했을 때 모든 링크의 설계 용량도 공개 규제 신고를 통해 알려져 있음. 따라서 저자는 LSN 토폴로지에 대한 완전한 사전 지식을 가정함. 또한, 최단 경로의 변경은 몇 초의 시간 단위로 발생함. ==네트워크의 최대 전달 지연이 약 125ms 이므로 공격자는 LSN을 스냅샷으로 보고 스냅샷의 연속에 대한 공격을 계산할 수 있음==

*공격자가 위성 네트워크의 현재 상태를 일정 시점에 고정된 형태로 파악하고 이러한 고정된 상태들을 연속적으로 분석함으로써 공격 계획을 세울 수 있다는 의미. LSN은 위성들이 빠르게 움직이기 때문에 네트워크의 구성과 연결 경로가 지속적으로 변함. 하지만 공격자는 이러한 동적인 상황을 단순화시켜 처리할 수 있음. ==이들은 특정 시점에서의 위성들의 위치와 네트워크의 구성을 '스냅샷'처럼 캡처하여 분석함. 이렇게 각 시점에서의 네트워크 상태를 연속적인 스냅샷으로 분석함으로써 위성들이 움직이면서 변화하는 네트워크의 상태를 예측하고 이를 바탕으로 효과적인 공격 전략을 수립할 수 있음==.* 

**Routing.** 토폴로지가 알려져 있으며, 모든 시간에 각 링크를 통한 전파 지연 또한 알려져 있음. 따라서 많은 봇 사이의 지연 측정이 빈번하게 이루어질 경우 공격자는 Route가 어떻게 선택되는지 결정할 수 있음. 이는 토폴로지와 전달 지연이 알려지지 않은 상황보다 훨씬 간단한 네트워크 토모그래피(Tomography) 설정임. 라우팅이 결정적인 경우(예: 최단 경로 라우팅), 공격자는 미리 어떤 소스-목적지 쌍에 대한 전체 전달 경로를 계산할 수 있음. 라우팅이 무작위화된 경우(예: 거의 최단 경로를 통한 부하 균형) 저자는 공격자가 부하 균형 집합이 구성되는 알고리즘을 알고 있다고 가정함. ==따라서 공격자는 트래픽이 취할 수 있는 가능한 경로를 미리 알지만 특정 흐름을 전달하기 위해 선택된 실제 경로는 알지 못함.==

**Bot locations & availability.** LSN의 주요 장점은 글로벌 커버리지, 잠재적으로 봇의 다양한 위치를 제공함. 단말기 자체는 안전하더라도 단말기를 통해 연결된 사용자 디바이스를 침해하는 것으로 충분하기 때문에 오늘날 봇넷을 생성하는데 사용되는 Exploit은 위성 지원 봇넷의 경우제도 직접적으로 적용됨. 따라서 공격자가 지상의 모든 위치에서 TU를 손상시킬 수 있다고 가정함. 오늘날에도 TU에는 신호 획득을 지원하는 GNSS 기반 자체 위치 확인 기능을 갖추고 있기 때문에 공격자는 봇의 위치를 정확하게 파악할 수 있음. 

봇넷의 크기와 관련하여 저자는 업링크 용량에 의해 제한되는 한도를 넘어서는 어떤 위치에서도 손상된 TU의 수를 제한하지 않음. ==공격에 성공하기 위해서는 수백에서 수천개의 손상된 TU만 있으면 되는데 이는 전 세계적으로 사용할 수 있을 것으로 예상되는 수천만 개의 TU중 극히 일부에 불과함==(SpaceX는 미국에서만 5백만 개의 TU에 대한 허가를 신청함)

**Attack control channel. **공격자는 최신 봇넷에서 흔히 볼 수 있는 명령 및 제어 채널을 통해 봇 집단을 조정할 수 있다고 가정함. 공격자는 토폴로지, 라우팅 알고리즘, 봇 위치에 대한 사전 지식을 통해 공격 트래픽 명령을 미리 계산하여 봇에 전파할 수 있음. 공격자가 극도로 단기간(예: 수십 밀리초) 정체를 유발하려는 경우에는 봇 간에 세분화된 시간 동기화가 필요함. 이는 GNSS를 통해 쉽게 이루어질 수 있음



## 3.4. Unique attack opportunities & challenges

==위의 논의는 LSN을 표적으로 삼는 공격자가 기존 지상 네트워크를 표적으로 삼는 공격자와 비교할 때 몇 가지 장점이 있다는 점을 강조함.==

* 공격자는 네트워크 토폴로지에 대한 완전한 엑세스 권한을 갖게됨 위성의 위치는 정기적으로 발표되며, 미래에도 높은 정확도로 예측할 수 있음. 또한 상호 연결의 설계 세부 사항은 위성 사업자가 제출해야 하는 FCC 요청에서 추론할 수 있음. 이와 대조적으로 지상파네트워크의 토폴로지는 숨겨저 있으며 심지어 난독화될 수 있음.
* LSN의 글로벌 노출을 고려할 때 공격자는 다양한 위치에서 봇을 모집하여 공격 트래픽을 생성할 수 있음
* 최단 경로 또는 최단 경로에 가까운 경로를 사용해야 하므로 LSN의 저지연 목표는 라우팅 예측 가능성으로 이어짐
* 이미 잘 연결된 지역의 경우, 지상 광케이블 경로가 더 저렴하기 때문에 LSN의 주요 가치는 낮은 지연 시간임. 따라서 공격자의 부담이 줄어듦. 공격자는 타깃 소스-목적지 쌍 사이에서 네트워크 그래프의 한 부분을 혼잡하게 만들 필요 없이 바람직한(지연 시간이 짧은) 경로의 작은 집합만 저하시키면 됨. 
* LSN의 토폴로지 및 경로 구조를 분석한 결과 특정 링크가 다른 링크보다 더 취약하여 공격자가 쉽게 공격할 수 있는 것으로 나타남
* 시스템의 예측 가능성을 악용하면 봇과의 통신이 비동기식으로 이루어질 수 있으므로 기존의 명령 및 제어 트래픽 탐지가 어려워짐



==그러나 LSN 설정의 일부 측면은 공격자에게도 위협이 될 수 있음==

* 각 봇은 제한된 리소스를 가지고 있으며, 사용 가능한 봇 풀은 인터넷에 연결된 호스트 중 봇으로 사용될 수 있는 호스트의 극히 일부에 불과함 따라서 공격자가 공격 비용을 낮게 유지하는 것이 더욱 중요함
* 공격자는 봇의 트래픽이 타깃 링크에 도달하기 전에 링크를 혼잡하게 만드는 자체 혼잡으로 인해 제한된 공격 리소스가 낭비되지 않도록 해야함
* 일부 위성의 업링크를 혼잡하게 하여 바로 아래에 있는 많은 수의 봇을 악용하는 것은 탐지를 피하려는 공격자의 요구에 반하는 것임. LSN은 중앙에서 관리되는 도매인 내 네트워크이므로 지상 전송 네트워크보다 더 나은 모니터링 및 정책 기능을 갖추고 있음. 따라서 공격자는 더 은밀해야 하며, 더 멀리 떨어진 곳에 봇을 배치하고 분산된 봇 모음을 활용해야 함
* LSN이 여러 경로에 걸쳐 무작위 로드 밸런싱을 사용하는 경우 공격자가 라우팅을 예측할 수 없게 되어 잠재적으로 더 많은 리소스를 소비하는 확률적 접근 방식이 필요함

저자의 공격 방식은 앞서 언급한 고유한 기회를 악용하는 동시에 새로운 도전 과제를 해결한다고 주장



# 4. ICARUS attack: shortest-path routing

LSN이 단일 최단 경로 라우팅을 사용하는 더 간단한 설정에서 LSN에 대한 ICARUS 서비스 거부 공격에 대해 설명함. 이 경우 지연 시간이 짧지만 결정적 라우팅은 공격자에게 도움이 됨

## 4.1. Attack mechanism

LSN의 경로는 일반적으로 초 단위로 안정적임. 따라서 공격자는 네트워크의 정적 스냅샷에서 봇이 전송해야 하는 흐름(flow)를 계산하고 새로운 flow를 전송하기 전에 몇 초 동안 동일한 flow 할당을 사용할 수 있음. 공격자는 경로가 변경되는 시간도 알고 있으므로 변경이 없는 기간에 flow 할당을 계획할 수 있음. 전체 시스템을 훨씬 더 긴 시간 범위에서 완전히 예측할 수 있으므로 여러 기간 동안 미리 봇에 비동기적으로 할당을 전송할 수 있음. 특정 시스템 스냅샷의 경우 공격 흐름 세트는 Crossfire와 유사하게 다음과 같이 계산됨

#### A1

==링크 및 경로 탐색.==공격자는 알려진 위성 간 토폴로지를 사용하여 연결 그래프를 생성함. 각 봇의 시야에 있는 모든 위성을 계산하고 연결 가능한 각 위성에 대해 업링크와 다운링크를 연결 그래프에 추가함. 마지막으로 공격자는 모든 N(N-1)/2 쌍의 봇에 대해 다익스트라의 알고리즘을 실행하여 전달 경로를 찾음

#### A2

==경로 필터링.== 주어진 타깃 링크에 대해 공격자는 최단 경로로 타깃을 통과하는 모든 봇 쌍을 찾음. 공격자는 원하는(공격받는)방향으로 타깃을 가로지르는 경로만 유지함

#### A3a

==실현 가능한 공격 흐름 계산.== 공격자는 봇 쌍 간에 선택한 공격 경로에서 전송할 트개픽의 양을 결정해야 함. 공격자는 1. 표적 링크가 용량을 초과하지 않고 2. 다른 링크가 혼잡하지 않도록 흐름이 할당되어 있는지 확인함. 이러한 제약 조건을 충족하면 공격 트래픽이 공격 대산에 도달하기 전에 병목 현상을 일으키지 않고 공격 대상에 도달할 수 있음. 이 접근 방식은 공격 대역폭 측면에서 비용을 최소화함

#### A3b

MaxUp 감소. A3a가 실행 가능한 공격 흐름을 생성하면 공격자는 반복적으로 maxUp을 최적화함. 최대치인 D는 업링크에 걸친 최대 공격 트래픽 양임. 각 반복 i에서 공격자는 모든 업링크에서 허용되는 공격 트래픽 양인 Di를 낮춘 다음 타당성 검사를 다시 수행함. 이 과정은 공격이 여전히 가능한 최소값인 Dmin이 발견될 때 까지 반복됨.



## 4.2. Evaluation Setup

위의 공격 전략은 공격 시나리오에 따라 비용과 maxUp이 어떻게 달라지는지를 기준으로 평가함. 공격 시나리오는 개별 링크 또는 링크 세트 등 공격 대상과 이미 LSN을 사용하는 정상 트래픽의 유형에 따라 달라짐. 전체적으로 총 1584개의 위성이 있는 SpaceX Starlink shell1 별자리에서 시뮬레이션을 사용함. 그러나 평가 프레임워크는 임의의 구성도 지원하므로 다른 구성에 대한 결과 예씨는 부록 자료에 포함되어 있음. 봇과 양성 TU는 지상의 어느 지점에나 위치할 수 있다고 가정함. 시뮬레이션을 추적 가능하게 유지하기 위해 지리적 위치의 연속 공간을 일반 측지 격자로 이산화함. 이 작업은 지구를 삼각형으로 타일링 하는 형태로 이루어지며, 육지 영역으로 제한하면 총 171개의 가능한 위치가 됨.(육지 지역으로 제한하는 것은 인구와 경제 활동을 기반으로 하는 아래 양성 트래픽 모델에 따라 결정됨). 각 삼각형 타일은 100,000km의 면적을 나타냄. 단일 starlink 위성은 이 크기의 10배에 달하는 면적을 커버하므로, 이 그리드는 동일한 위성과 관련된 다양한 TU 배치의 늬앙스를 포착하는데 충분함

LSN의 정상 트래픽에 대해 세 가지 트래픽 시나리오를 테스트함

* 빈 네트워크: 정상 트래픽이 없는 경우, 기존 트래픽의 영향을 파악할 수 있는 기준이 됨
* GDP 트래픽: '중력'샘플링 모델로 두 위치 사이에 10Mbps의 양성 트래픽을 추가할 확률은 해당 위치의 GDP의 곱에 비례함. 각 타일의 중심은 트래픽 소스/sink 위치 역할을 하며, 타일 면적에 대한 총 GDP는 이 위치의 GDP 가중치가 됨. 그런 다음 25만 번 샘플링하여 추가되었을 때 링크 용량의 90%를 초과하는 샘플은 버림. 이 과정을 통해 on-land uplink 용량의 28%를 활용하게 됨. 이 모델은 트래픽을 경제 활동에 비례하는 것으로 간주하여 가장 큰 경제 중심지가 트래픽과 수익을 주도할 것이라는 관점을 나타냄
* Pop 트래픽: 위와 유사한 중력 모델이지만 GDP 대신 인구가 가중치로 사용됨. 이 모델은 인구는 많지만 여전히 연결 상태가 좋지 않은 지역의 커버리지를 개선하는 것이 LSN의 주요 역할인 시나리오를 나타냄. 이 모델에서는 34%의 활용도를 얻음\

모든 시뮬레이션은 LSN 시뮬레이션 프레임 워크에 의해 실행됨



## 4.3. Single link target scenarios

#### Attacking an uplink

업링크 공격의 결과는 쉽게 확인할 수 있음. 공격자가 피해 위성 업링크의 커버지리 영역에 충분한 봇을 보유하고 있지 않다면 공격은 성공할 수 없음. ==따라서 이 공격은 공격자가 업링크를 공격 트래픽으로 완전히 채워하 하므로 저자의 모델에서 최대 maxUp을 가짐==

#### Downlinks

==업링크와 달리 다운링크는 임의로 멀리 떨어진 곳에서도 접속할 수 있으므로 공격자는 다운링크를 혼잡하게 할 봇을 더 쉽게 찾을 수 있음.== 이론적으로 공격 flow는 자체 정체를 일으킬 수 있음. 공격 트래픽이 표적 다운링크를 향해 흐르면서 점점 더 많은 flow가 경로에 합류하여 표적에 이르는 ISL을 채움. 이는 A3a의 제약 조건 2번을 위반할 수 있지만 다운링크에 대한 공격의 경우 타겟 다운링크에 선행하는 모든 ISL이 다운링크 혼잡에 필요한 대역폭의 5배를 전달할 수 있기 때문에 발생할 가능성은 거의 없음. ==결과적으로 시뮬레이션 결과, 지상에 위치한 위성의 모든 다운링크는 이러한 방식으로 공격할 수 있는 것으로 나타남.==저자의 모델은 해상에서 TU를 허용하지 않기 때문에 나머지 위성의 다운링크를 혼잡하게 할 방법이 없음. 또한 이 결과는 세 가지 트래픽 모델에 관계없이 동일하게 유지되는데, 이는 정상 트래픽이 있더라도 상대적으로 적은 양의 공격 트래픽 대역폭을 위해 네트워크에 항상 충분한 용량이 남아있기 때문

#### ISL

==ISL은 업/다운링크보다 대역폭이 높기 때문에 공격이 더 복잡하고 비용이 더 많이 듬.== 다운링크에 비해 ISL에서 정체를 유발하는 데 더 많은 공격 트래픽이 필요할 뿐만 아니라, 실제로는 타깃 ISL로 향하는 공격 플로우에서 자체 정체가 발생하는 경우가 많음. 결과적으로 6336개의 가능한 ISL 타깃 링크(1584개의 위성 각각 4개의 ISL, 양방향 모두 포함) 중 빈 네트워크 시나리오에서 실현 가능한 링크는 5470개(86%)에 불과한 것으로 나타남. GDP 또는 Pop 트래픽을 포함하면 이 수치는 각각 72%와 71%로 떨어짐. 이는 예상대로 트래픽이 많으면 공격 흐름 경로의 가용 용량이 감소하여 표적에 도달하는 트래픽이 제한되기 때문임

시뮬레이션 결과 흥미로운 점은 세 가지 모델 모두에서 공격자가 혼잡을 유발할 수 있는 ISL이 하나 이상 포함된 end-to-end 경로 중 ISL이 하나도 포함되지 않은 경로가 0.6 미만이라는 점임. ==따라서 이 공격은 ISL에 의존하는 모든 통신의 99.4% 이상을 방해할 수 있음==

#### Cost and maxUp

업링크의 경우 공격 대상 업링크 아래에 충분한 봇이 있는지 여부에 따라 공격 가능 여부가 결정되고, 육상을 통한 모든 다운링크는 공격이 가능하며, ISL의 경우 자체 혼잡으로 인해 공격 가능 여부가 제한되며, 세부 사항은 정상 트래픽에 따라 달라질 수 있음. 실행 가능한 공격의 경우 공격 비용과 최대 업도 분석할 수 있음

![image-20240128044909422](assets/image-20240128044909422.png)

**그림 2: 단일 표적 공격의 비용 및 maxUp.** 기준 트래픽이 있든 없든 maxUp은 비슷하게 분포되지만 공격 비용은 크게 감소함. 

그림 2는 세 가지 트래픽 모델 모두에 대해 공격이 가능한 모든 링크(다운 링크와 ISL을 합친 것, 업링크는 앞서 설명한 대로 중요하지 않으므로 생략)에 대한 공격 비용과 최대 공격 횟수를 보여줌. 비용 그래프를 보면 빈 네트워크의 경우 ==CDF에는 모든 다운링크는 0.2, 모든 ISL은 1의 공격 비용이 드는 단 두 가지 경우만 있음을 알 수 있음. 이것은 링크를 혼잡하게 만들려면 대상 링크의 용량만큼의 트래픽을 전송해야 하므로 정상 트래픽이 있는 경우 두 트래픽 모델 모두 공격자는 기존의 정상 트래픽에 최대 대역폭에 비해 더 적은 양의 트래픽을 추가하면 되므로 공격 비용이 더 낮음.== 봇 수 측면에서 1의 비용은 수백 개의 봇이 각각 수십 Mbps를 전송하는 것을 의미함. 

maxUp 플롯은 다양한 타깃 링크에 대한 공격의 maxUp의 분포를 보여줌. ==위성의 업링크를 완전히 포화시키는 것이 공격자에게 최악의 경우이므로 최대 업링크 대역폭으로 정규화하여 최대 업링크 대역폭은 1이됨==. 빈 네트워크 시나리오에서 중간 타깃 링크에 대한 공격의 maxUp은 0.13 미만이다. 따라서 이러한 표적 링크로 전송되는 공격 흐름에서 소비되는 최대 위성 업링크 대역폭은 업링크 대역폭의 약 1/8을 차지함. 두 트래픽 모델 중 하나를 사용하여 네트워크에 정상 트래픽을 추가하면 공격자의 탐지 위험을 더욱 낮출 수 있음

정상 트래픽을 추가하면 공격 가능한 표적 링크에 대한 공격 비용과 최대 공격 횟수가 감소하지만, 실제로는 공격 가능한 표적 링크의 비율이 감소한다. 그러나 자세히 살펴보면 이는 공격자에게 특별히 심각한 문제가 아니라는 것을 알 수 있다. 양성 트래픽이 존재할 때 취약성이 낮아지는 링크는대부분 대양 위ㅉ고이며, 인구가 많은 지역의 고가지 링크가 아니다.



## 4.4. Multi-link region disconnection scenarios

공격자는 개별 링크과 이를 통과하는 통신을 공격하는 것 외에도 두 개의 넓은 지리적 영역 간의 모든 통신을 방해하려고 할 수 있다. 이를 위해서는 ==두 지역을 연결하는 모든 경로를 동시에 혼잡하게 만들어야 한다.== 공격자는 이제 혼잡을 유발할 목표 링크 세트를 신중하게 선택해야 하므로 공격이 더욱 어려워 진다. 지역 간 연결을 방해하는 것은 비용이 적게 들고 maxUp이 낮다. 그림 3은 다음과 같은 예시를 보인다.

![image-20240128225049531](assets/image-20240128225049531.png)



**그림 3: 지역 연결 단절의 예**. 미국 북서부와 호주 북서부 사이에는 12개의 서로 다른 최단 경로가 존재하지만, 이 넓은 지역 간의 통신을 방해하는 병목 현상은 단 3개에 불과하다.



공격자는 12개의 서로 다른 경로에서 공유되는 3개의 병목 지점을 지능적으로 선택하여 공격 비용을 크게 절감할 수 있음. 그러나 많은 경우 선택이 명확하지 않음. 공격자는 구역을 연결하는 경로에 있는 링크들 중에서 동시에 공격할 수 있는 최소한의 링크 집합을 선택해야 하며, 이 링크들의 혼잡으로 인해 연결이 완전히 끊어지게 된다. 이 문제는 최소 집합 커버 문제와 동일하며, 이는 NP-hard 문제이다.

==기하급수적인 폭발을 피하기 위해 저자는 다항식 시간 내에 공격할 링크 집합의 근사치를 계산하는 휴리스틱을 사용함.== 혼잡 경로의 각 링크에는 해당 링크에 대한 공격의 최대치(maxUp)와 링크를 공유하는 경로의 수 사이의 비율에 해당하는 점수가 할당됨. 이 점수가 낮을 수록 해당 링크를 공격하는 것이 더 은밀해짐. 따라서 점수가 가장 낮은 링크를 공격 세트에 추가하고 이 링크가 혼잡한 모든 경로와 함께 네트워크에서 제거한 다음, 마지막으로 나머지 모든 링크에 대한 점수를 다시 계산함. 모든 경로가 혼잡해질 때 까지 이 절차를 계속함. 이 휴리스틱을 세 번 실행하여 링크가 제거되는 순서를 약간 변경하고 가장 낮은 maxUp 결과를 유지함

*__NP-hard__: 계산 복잡성 이론에서 사용되는 용어로, 어떤 문제가 NP-hard라고 할 때 그 문제는 비효율적으로 풀기 어려운 문제를 의미함. 즉, 이 문제를 풀기 위한 알고리즘은 현재까지 알려진 바로는 다항 시간 내에 해결될 수 없다는 것을 의미*'

*__다항식 시간(Polynominal time)__:컴퓨터 과학과 계산 복잡성 이론에서 사용되는 용어로, 알고리즘이 문제를 해결하는 데 걸리는 시간이 입력 크기의 다항식에 비례하여 증가한다는 것을 의미함. 다항식 시간 내에 해결 되는 문제는 일반적으로 "효율적으로 해결 가능한 문제"로 간주됨*

 ![image-20240128225204124](assets/image-20240128225204124.png)

**그림 4: 지역 연결 단절 공격의 비용과 maxUp**. 한계 값에서 볼 수 있듯이 대부분의 공격에서 maxUp은 낮음. 비용 한계에 표시된 피크는 영역 간 경로의 병목 지점 수에 해당함.

### Simulation result

측지 격자(geodesic grid)에서 각각 6개의 지점으로 구성된 5000쌍의 지역을 반복적으로 샘플링 함. 각 쌍에 대해 소스 지역과 목적지 지역을 반적시켜 공격을 두 번 실행하여 총 9658개의 실행 가능한 공격 사례를 도출함.(일부 사례는 영역이 겹쳐서 버려짐) 이는 그림 4에 나와있음.

==이러한 영역 쌍 중 9208개(95%)가 완전히 공격에 성공할 수 있는 것으로 나타남.== 이러한 공격의 maxUp 중앙값은 0.10으로 넓은 영역을 공격해도 단일 링크 공격(maxUp이 0.13인 경우)에 비해 적대적인 노출이 더 적다는 것을 의미함. maxUp의 사소한 차이는 영역 구성 알고리즘이 단일 링크 공격에서 maxUp의 중앙값을 증가시키는 일부 corner cases를 방지하기 때문에 발생함. 영역은 여러 그리드 포인트로 구성되기 때문에 위성 연결의 가장자리(고위도 또는 대륙의 좁은 코너)에서 멀리 떨어져 있어야 하므로 공격자가 공격 트래픽을 분산시킬 수 있는 업링크가 더 많아짐. 마지막으로 전체 비용은 주로 발견되는 병목 현상 수(그림 4의 한계선에 급증하는 것이 특징)에 의해 결정되며, 이 수치는 지속적으로 4 미만임



# 5. ICARUS against more sophisticated routing

단일 최단 경로 라우팅 설정은 주로 LSN의 취약성에 대한 직관력을 키우고 공격자의 Tradeoffs를 폭넓게 이해하기 위해 사용함. 실제로는 LSN이 여러 경로에 걸쳐 트래픽을 로드 밸런싱하는 시나리오가 더 가능성이 높음. 따라서 이러한 부하 분산을 위한 몇 가지 후보 라우팅 체계를 고려한 다음 이보다 복잡한 설저엥 적합한 수정된 공격 전략을 수립하고 평가함



## 5.1. Candidate routing schemes

새로운 라우팅 전략을 개발, 평가, 비교하는 것은 저자의 목표가 아니며, 이전 작업에서 어느정도 심도있게 다루었음. 그러나 여러 경로에 걸친 부하 분산이 공격자에게 어떤 영향을 미치는지 이해하려면 몇 가지 적절한 라우팅 방법을 설정해야 함. 여기서는 한 가지 기본 제약 조건을 사용함. ==최단 경로가 아닌 경로를 선택하더라도 지연 시간을 크게 늘리지 않아야 한다는 것임.== 극단적으ㅡ로, 어떤 경로의 지연 시간도 지상 광케이블 경로의 지연 시간을 초과해서는 안됨. 따라서 다음과 같은 다중 경로 라우팅 변형을 평가함

#### k-SP 

최단경로(Shortest paths): 이 전략은 최단 소스-목적지 경로 간의 트래픽 부하를 분산함

#### k-DG

지상-지상 분리 경로(Ground-toground disjoint paths): 이 전략은 노드 간 비연결 경로, 즉 공유 업링크, 다운링크 또는 ISL이 없는 최단 경로 k 개만 고려함

#### k-DS

위성 간 분리 경로(Satellite-tosatellite disjoint paths): 이 전략은 위와 유사하지만 업링크와 다운링크에서 중첩이 허용된다는 점을 제외하면 위와 유사하다. 분리 경로는 ISL에서만 적용됨

#### k-LO

제한 중첩 최단 경로(Limited-overlap shortest paths): 유사도 점수가 50% 이하인 최단 k 경로를 찾는 휴리스틱인 Chondrogiannis의 ESX 알고리즘을 구현함



간혹 이러한 알고리즘은 광섬유보다 빠른 속도와 경로 불연속성 제약 조건으로 인해 k 경로보다 적은 수의 경로를 생성하는 점에 유의해야 한다.(k-SP의 경우 전자의 경우만 적용되며, 가까운 엔드포인트에 대해서만 제한됨). 각 알고리즘은 경로가 겹치는 정도에 따라 서로 다운 유형의 최단 경로를 고려함. 겹침을 제한하지 않는 ==k-SP는 일반적으로 최단 경로와 거의 동일한 지연 시간을 가진 여러 경로를 제공하지만 이러한 경로를 가로지르는 공유 링크가 병목 현상이 될 위험이 있습니다.== 반면 가장 제한적인 방식인 k-DG는 일반적으로 4개 이상의 경로를 제공하지도 않음. 이러한 알고리즘의 경로 구조에 대해 자세한 분석은 부록에 있음. 각 방식에 대해 LSN이 선택한 경로에서 무작위 로드 밸런싱(ECMP와 유사)을 사용한다고 가정함. 균일한 무직위 부하 분산은 공격자에게 최악의 경우이며, 모든 결정론적 적응 방식은 공격자의 불확실성을 엄격하게 줄임



### 5.2. Probabilistic ICARUS(Summarized)

부하가 분산되고 균일하게 무작위화된 라우팅을 사용하면 링크 검색 단계의 불확실성이 줄어듦. 네트워크는 밀 계산된 일련의 경로 중에서 전달 시점에만 end-to-end 경로를 선택하기 때문에 공격자는 공격 트래픽이 어떤 특정 경로를 택할지 미리 알 수 없음. 따라서 저자는 이러한 불확실성을 고려한 확률적 변종 ICARUS를 제시함. 이 공격은 공격 흐름 간의 자기 혼잡을 피하고 maxUp을 낮추면서 표적 링크에 높은 확률로 혼잡을 일으키는 방식으로 공격 흐름 할당을 수행함



### Congesting the Target

공격자는 대상 링크를 확률적으로 혼잡하게 하여 트래픽을 초과시키려 함. 이를 위해 여러 경로 중 하나가 대상 링크를 포함하도록 소스-목적지 쌍을 선정하고 이들 중 일부가 대상 링크를 거치는 경로를 이용함

**체르노프 경계를 통해 근사치를 구함**

### Avoiding self-congestion.

공격자는 대상 링크에 집중하면서 다른 링크에는 트래픽을 초과시키지 않도록 주의함. 이는 대상 링크를 혼잡하게 하는 것과 유사한 분석을 비대상 링크에 대해서도 수행하으로써 달성됨

### Probability of attack success.

공격이 성공하려면 대상 링크만 혼잡해야함. 실패 확률을 계산하고 이를 최소화하여 전체 공격 성공 확률을 증가시킴

### Attack set construction

 공격자는 위에서 계산된 확률을 바탕으로, 목표와 비목표 링크에 대한 기대치를 만족시키는 공격 흐름 세트를 구성함

### Further optimization

특성 소스-목적지 쌍이 항상 대상 링크를 사용하는 경우에는 별도로 고려하여 확률적 분서을 최적화함



## 5.3. Evaluation

4가지 라우팅 체계에서 k=5개의 경로와 경로 전체에 걸쳐 균일한 무작위화를 사용하여 동일한 구성인 Starlink shell 1을 사용하여 확률론적 ICARUS를 평가함. 공격자에게 가장 많은 비용이 드는 빈 네트워크 시나이로에 대한 결과를 제시함

![image-20240129012710041](assets/image-20240129012710041.png)

**(a)** 비용 최소화로 실행할 떄 공격에 대한 비용 CDF, maxUp은 5.2의 텍스트를 참조

![image-20240129012810331](assets/image-20240129012810331.png)

**(b)** maxUp 최소화로 실행할 때 공격에 대한 CDF 비용. 이전 수치에 비해 비용이 크게 증가하지만 maxUp의 이점이 있음.(아래)

![image-20240129012904734](assets/image-20240129012904734.png)

**(c)** 공격에 대한 MaxUp CDF를 최대화 하기 위해 실행

최대 공격 실패 확률 a를 10%로 설정하고 공격 세트의 크기에 따라 공격자의 비용을 측정함. 탄력적인 라우팅 체계는 공격자가 동일한 a에 대해 더 높은 공격을 부담하게 하는 반면, 취약한 라우팅 체계는 단일 최단 경로 라우팅 경우에 가까운 비용을 발생시킴. 이러한 직관을 따라 저자는 후자와 비교하여 다양한 라우팅 방식의 공격 비용을 제시함

그림 5a와 5b는 공격자가 비용과 maxUp을 최적화할 때 모든 4가지 라우팅 방식에 대한 공격 비용을 보여줌. 놀랍게도 5-DG와 5-SP는 비슷하게 수행되는데, 이는 둘 다 매우 다른 방식임에도 불구하고 그러함. 전자는 동일한 (s,d) 쌍에 대해 경로 간의 중복을 허용하지 않는 반면, 후자에서는 경로 중복에 대한 제한이 전혀 없음. ==그러나 공통점은 두 경우 모두 전달 경로에 대한 불확실성이 낮다는 것임. 5-SP에서는 SN내에서 5개의 절대적으로 가장 짧은 경로 간에 분리가 부족하기 때문임. 반면에 5-DG에서는 대안 부족으로 인해 불확실성이 낮음.== 많은 (s,d) 쌍 사이에서 이 방식은 지나치게 제한적이며 5개의 경로를 제공하지 못함. 이로 인해 적은 공격 흐름 세트에서 해당 (s,d)쌍을 사용하여 라우팅 불확실성을 효과적으로 우회할 수 있음

==공격자의 비용을 증가시키는데 가장 좋은 방식은 5-DS임.== 이 방식은 경로 중복을 피하면서도 충분한 경로 옵션을 유지하기에 충분히 유연한 균형을 유지함. 위성 간의 분리를 강제하는 것은 지상 간의 분리보다 제한적이지 않음. 단일 최단 경로 라우팅과 비교할 때 중간 비용 증가는 5-DS로 385%임. 이러한 탄탄함의 대가는 증가된 지연시간임. 이 경로는 종종 최단 경로에 비해 1.5배 이상의 지연 시간을 발생시킴

높은 지연 시간 비용을 발생시키는 동안에도 비용 증가율이 크다고 보이는 것(385%)과는 달리 실제로 이는 여전히 80Gbps 미만의 공격 트래픽에 불과하며 몇 천 개의 봇(봇 당 대역폭에 따라 다름)을 가진 봇넷은 여전히 중간 LSN 링크를 혼잡시킬 수 있음. 또한 이 비용은 가장 어려운 설정, 즉 어떠한 선의의 트래픽도 없고 LSN이 큰 지연 시간 악화를 받아들이며, 공격자가 maxUp을 최소화하려고 하는 상황에서 발생함. 더욱이 육지 위의 중요한 링크는 공격하기가 더 쉬움. 부록의 그림2는 5-DS를 사용할 때 네트워크의 ISL에서 공격 비용이 가장 높은 곳을 보여줌. 육지 위의 ISL을 공격하는 것이 더 쉬운 이유는 적이 경로가 적거나 크게 중복되는 소스-목적지 봇 쌍을 항상 찾을 수 있기 때문임(불확실성이 감소함)

maxUp에 대해서는 그림 5c에서 보여주듯이, 5-SP가 이상치로, 다른 세 가지 방식과 비교했을 때 더 높은 maxUp을 가짐. 이는 다른 알고리즘이 종종 같은 부하 균형 세트에서 여러 개의 업링크를 사용할 수 있기 때문이며, 이로 인해 공격 트래픽을 분산시켜 maxUp을 줄임. 반면에 5-SP에서는 경로가 대부분 겹치며, 특히 업링크에서 이 효과를 방지함



# 6. Open problem: exploiting LSN dynamics

지금까지 제시된 공격은 SN 상태의 스냅샷만을 고려하며, 공격자는 공격 흐름을 사전 계산하기 위한 몇 초의 시간 단위로 네트워크의 상대적 안정성을 이용함. 공격자가 공격 흐름 집합을 자주 변경해야 하는 사소한 장애가 아니라 공격자가 LSN의 역학을 추가적인 기회로 악용할 수 있는 방법/여부를 고려할 필요가 있음. 이러한 유형의 두 가지 잠재적 기회에 대해 설명함.

![image-20240129014339366](assets/image-20240129014339366.png)

**그림 6: Load Surges** 이 그림은 부하가 가장 많이 급증한 10개 링크의 시간 경과에 따른 링크 트래픽을 보임. 가장 큰 Positive(-) 및 Negative(- -)의 급증도 강조 표시 되어 있음

### Load Surges.

위성의 움직임으로 인해 ISL이 저사용 및 고사용 지역을 지나간다. 결과적으로 네트워크 링크의 사용량이 시간에 따라 크게 변동하게 된다. 130초 동안의 GDP 트래픽 모델 시뮬레이션에서 링크 부하 변화를 그림 6을 통해 알 수 있다. 공격자가 LSN의 트래픽 매트릭스를 알거나 합리적으로 추측할 수 있다면 이러한 부하 급증을 이용하여 저용량 공격의 효과를 증가시킬 수 있다. 자연적인 부하 급증과 일치하는 잘 타이밍된 폭발적 공격이 비용의 일부로 높은 혼잡을 유발할 수 있다. 이러한 공격의 효과는 LSN의 프로토콜 스택에 따라 달라지는데(혼잡 제어가 짧고 일시적인 혼잡을 감지하고 회복하는 데 얼마나 걸리는지) 이 문제는 패킷 수준의 분석이 필요하여 미래의 연구로 남겨둔다.

![image-20240129014504397](assets/image-20240129014504397.png)

**그림 7: 펄싱 공격의 가능성**

### Pulsing Attacks.

LSN의 또다른 동적 특성은 경로의 시간 변동성이다. 특정 링크를 거쳐 목적지 d로 가는 경로를 가진 봇을 고려해보면 시간이 지남에 따라 이 경로가 변경될 수 있다. 경로 변경으로 인해 대상 링크를 건너는 공격 트래픽의 효과적 대역폭이 두 배가 될 수 있다. 이러한 'Pulsing Attack'은 Temporal lensing과 유사하지만 LSN에서는 네트워크의 고유한 동적 특성에 의해 제공된다.

Pulsing Attack의 실행 가능성을 간단히 테스트하기 위해 다음 실험을 수행했다.

1. 각 시간 단계에서 대상 링크를 고려하고 그것을 통과하는 모든 경로를 계산함
2. 다음 시간 단게에서 유효하지 않을 경로를 식별하고 그 대체 경로를 계산함
3. 변경된 각 경로에 대해 원래 경로와 그 대체 경로 사이의 대상 링크까지의 지연 시간 차이를 계산함

이 절차를 130초 시뮬레이션과 1초 시간 단계 평가를 위해 모든 6336개의 대상 링크에 대해 수행함

그림 7에서 몇 가지 라우팅 방식에 대한 결과를 보여줌

단일 최단 경로 라우팅의 경우, 경로 변경에 걸친 수십 밀리초의 지연 시간 차이를 전체 위성군에 걸쳐 시뮬레이션 초당 한 번 미만으로 달성 가능함. 다중 경로 방식은 이 기회를 증가시키지만 여전히 작음. 가장 유리한 알고리즘인 5-DS의 경우에도 8133개의 펄스만이 50ms 이상 지속됨. 6336개의 대상 ISL이 있으므로, 공격자는 전체 130초 시뮬레이션 동안 평균적으로 ISL당 1회 이상의 펄스로부터 혜택을 얻을 수 있음. 따라서 펄싱은 원칙적으로 가능하지만 유용성은 소수의 대상에 대한 간헐적인 영향에 국한됨



# 7. Mitigations

DDoS 공격에 대응하는 몇 가지 전통적인 방버이 ICARUS에는 적용되지 않는다는 사실을 발견함.

* 예상되는 트래픽보다 많은 양을 흡수할 수 있는 Overprovisioning은 어려움. 모델은 이미 ISL이 접속 링크보다 높은 용량을 가진다고 가정하고 있으며, ISL 용량이나 수를 늘리는 것은 위성의 비용, 무게, 전력 제약에 영향을 미침
* In-network filtering은 위성과 TU 모두 계산 자원이 부족하여 어려움. Coremelt와 Crossfire와 마찬가지로 공격 트래픽은 실제 트래픽과 구분이 불가능함.
* 암호화 토큰과 같은 권한 부여 방식은 유용하지 않음. 공격자는 합법적인 위성 연결 사용자를 타협하여 LSN에 접근 권한을 얻으므로 이 사용자들의 권한을 상속받음
* 클라우드 기반 대응 방법은 필터링을 클라우드로 오프로드 하지만 TU가 LSN을 마지막 마일 공급자로 자주 사용하기 때문에, 클라우드 공급자를 통한 트래픽 전송의 부담은 LSN에 있으며 추가적인 대역폭과 지연 시간 오버헤드를 초래함

따라서 Coremlt와 Crossfire에 효과적인 방어책(용량 증가 또는 더 능력 있는 네트워크로 트래픽 재 라우팅)은 ICARUS의 영향을 완화하는데 사용할 수 없음



ICARUS 방어를 위한 가능성 있는 두 가지 접근 방법

### Resilient routing and network design

5.2에서의 실험은 탄탄한 라우팅이 공격 비용을 크게 증가시킬 수 있음을 보여줌. 테스트된 라우팅 방식의 경우 지연 시간이 증가하는 대가를 치러야 하지만, 탄탄한 라우팅을 탐색하는데 있어서 이는 시작에 불과함. 가장 유리한 tradeoff 곡선을 가진 라우팅 방식을 식별하는 것은 향후 연구의 흥미로운 방향임. 네트워크 토폴로지 디자인을 사용하여 문제를 해결하는 것도 가능. 전통적인 'Cross' 패턴에서 벗어나 전달 지연을 개선하기 위해 ISL을 재배열 할 것을 최근 제안. 비슷한 전략을 적대적 환경에서 사용할 수 있음. 네트워크 구조를 변경하면 지연 시간에 최소한의 영향을 미치면서 공격에 대한 탄력성을 향상시킬 수 있음

### Traffic seperation and differential pricing

해당 연구에서는 모든 TU가 동등하게 능력이 있다고 가정하지만, 모든 호스트가 이러한 최적화가 필요한 것은 아님. 이러한 고려 사항은 서비스의 다른 클래스를 만드는 기회를 열어줌. 프리미엄 서비스는 가장 낮은 지연 시간과 가장 높은 탄력성을 제공하지만, 다른 트래픽을 더 길고 예측하기 어려운 경로로 전환하는 대가를 치러야 함. 그러나 이것이 전달에 충분한 무작위성을 도입하여 공격을 수해아기에 비용을 많이 들게 만들지, 오히려 더 굴절된 경로로 인한 더 높은 자원 사용이 취약성을 증가시킬지는 아직 불분명함.



# 8. Other related work

### Attacks on satellite systems

물리 계층에서 위성 통신에 대한 가장 흔하게 인식되는 위협은 재밍임. 

ICARUS는 허가된 소스에서 프로토콜 준수 트래픽을 사용하기 때문에 재밍 분석기에서 탐지할 수 없음

GNSS 스푸핑은 잘 이해되고 있는 또 다른 위협으로 많은 공격과 대응책이 있음

최근에는 위성 통신에서 사용되는 암호화 표준의 보안과 그 부재에 대한 관심이 증가

LSN에서의 네트워크 계층 서비스 거부는 최근까지 지상 정지 궤도 위성 네트워크에 초점을 맞춤 Usman 등의 연구만이 LSN에서의 네트워크 계층 서비스 거부를 다룸

저자들은 위성을 통한 단순 굴절 연결만을 고려하고 ISL의 개념이 없음

본 연구에서는 현대 LSN의 완전히 다른 설정을 검토. 전혀 다른 유형의 공격을 분석함

### Routing in satellite constellations

LSN의 링크가 동적인 특성을 가지고 있기 때문에 많은 연구가 네트워크 상태 정보를 발견하고 전파하며 전달 지연을 최적화하는 도전 과제에 초점을 맞춤

Barrit 등은 LSN에 소프트웨어 정의 네트워킹(SDN) Temporospatial-SDN을 소개함

SDN 컨트롤러는 위성 궤도의 예측 가능성을 사용하여 LSN의 토폴로지에 대한 정확한 관점을 유지하고 라우팅 결정을 돕는데, 이 분야의 과거 연구에도 불구하고 ICARUS와 같은 공격자에 대한 탄력적 라우팅 최적화는 여전히 열린 질문



# 9. Conclusion

- ICARUS는 차세대 LSN에 대한 첫 번째 볼륨 DDoS 공격을 제시함
- 다양한 시나리오, LSN 라우팅 방식, 공격 대상에 걸쳐 ICARUS의 파괴적 잠재력을 입증함
- ICARUS의 효과는 LSN의 고유한 특성을 활용하여, 적이 지상 네트워크에 대해 사용할 수 있는 것보다 더 많은 정보를 가지고 LSN의 토폴로지와 경로 구조를 이용하는 데서 비롯됨
- ICARUS는 또한 LSN의 저지연 및 글로벌 커버리지 목표를 취약점으로 전환함
- 성공적인 네트워크 공격은 비용과 탐지 가능성의 제한이 필요하며, ICARUS는 이를 수행함
- 무작위 다중 경로 라우팅은 적의 비용을 증가시키지만, ICARUS는 그러한 설정에서도 성공을 입증함
- 본 연구는 LSN의 DDoS 취약성을 이해하기 위한 첫 걸음으로, 이 주제에 대한 추가 연구를 위한 기반을 제공함
- 이를 위해, LSN에서 DDoS 공격 및 방어를 분석하기 위한 첫 번째 도구인 시뮬레이션 프레임워크를 공개함, 이는 임의의 군집 구성 및 새로운 경로 선택 알고리즘의 탄력성을 쉽게 테스트할 수 있게 함















